
# Credencials ![image](https://github.com/user-attachments/assets/88c3dd49-bd0f-4926-9588-7e983cc76dd9)
1. Проверка STP, HSRP. Роль Root bridge и HSRP-active на одном устройстве. Команды: show spanning-tree, show standby на этом устройстве.
 [core2.txt](https://github.com/user-attachments/files/16759112/core2.txt)
2. Проверка маршрутизации на коммутаторах ядра. Show ip route. Должен присутствовать маршрут по-умолчанию и маршруты до интерфейсов ASA и бордеров.
  
   ![image](https://github.com/user-attachments/assets/04136f81-4ed2-44b1-b7d1-d6536429e880)

3. Проверка LAG на коммутаторах ядра show etherchannel summary.
    ![image](https://github.com/user-attachments/assets/4fc1d518-f3a2-4415-87aa-53bb1770ccb0)

4. Маршрутизация на бордерах sh ip route. В таблице маршрутизации должны присутствовать bgp-маршруты от провайдера, ospf-маршруты до внутренних подсетей ЦО и филиала.
   ![image](https://github.com/user-attachments/assets/621f6981-7a8e-4842-8aae-b07aeb5aa8b9)


5. Телефонные аппараты зарегестрированы на VoIP сервере, прозвон с одного на другой работает.
   
![image](https://github.com/user-attachments/assets/861baefc-0683-4739-bd80-19528e7caf66)

6. На все сетевые устройства можно попасть по учётной записи tacacs+ сервера.
   # ответ : Да, я проверил. Trust me, i am engineer
   
7. Время на устройствах синхронизировано. Show ntp status.
   ![image](https://github.com/user-attachments/assets/642b19ab-5c73-4d48-9072-1b2d52e8f42d)

8. Всё остальное тоже по идее работает корректно.




   По поводу GRE
   Протокол GRE: Недостатки и Альтернативы

Недостатки GRE:

1. Отсутствие аутентификации: GRE не обеспечивает аутентификации, что делает его уязвимым для атак типа "человек посередине".
2. Отсутствие шифрования: Данные передаются по сети в незашифрованном виде, что делает их доступными для перехвата.
3. Зависимость от маршрутизации IP: GRE полагается на маршрутизацию IP, что может привести к проблемам с маршрутизацией трафика.
4. Отсутствие управления полосой пропускания: GRE не предоставляет средств управления полосой пропускания, что может привести к перегрузке сети.
5. Сложность настройки: GRE требует сложной настройки, особенно в многоузловых средах.
6. Отсутствие поддержки QoS: GRE не поддерживает QoS, что может негативно повлиять на качество предоставляемых услуг.
7. Низкая производительность: GRE может создавать дополнительную нагрузку на сеть, что может снизить ее производительность.
8. Устаревший протокол: GRE - это устаревший протокол, который не рекомендуется использовать в новых проектах.
9. Отсутствие поддержки IPv6: GRE не поддерживает IPv6, что ограничивает его применение в будущем.
10. Проблемы с NAT: GRE может создавать проблемы с NAT, особенно в сложных сетевых конфигурациях.
11. Ненадежность: GRE не обеспечивает надежную передачу данных, что может привести к потерям пакетов.
12. Отсутствие поддержки multicast: GRE не поддерживает multicast, что ограничивает его функциональность.
13. Уязвимость для атак DoS: GRE может быть уязвим для атак типа DoS, что может нарушить работу сети.
14. Сложность отладки: GRE может быть сложным в отладке, особенно в случае проблем с маршрутизацией.
15. Отсутствие поддержки VPN: GRE не поддерживает VPN, что делает его непригодным для создания защищенных туннелей.

Альтернативы GRE:

* IPsec: IPsec обеспечивает аутентификацию, шифрование и управление полосой пропускания, что делает его более безопасным и надежным решением.
* SSL VPN: SSL VPN обеспечивает безопасное соединение между ЦО и филиалом с помощью шифрования SSL.
* WireGuard: WireGuard - это новый VPN-протокол, который отличается высокой скоростью и простотой настройки.
* OpenVPN: OpenVPN - это широко используемый VPN-протокол, который обеспечивает высокую степень безопасности и гибкость настройки.

Рекомендуется:

* Использовать IPsec, SSL VPN или WireGuard для создания защищенного туннеля между ЦО и филиалом.
* Избегать использования GRE в новых проектах из-за его недостатков в области безопасности и производительности.

* ----------------------------------------------------------------------------------------------------------------------------------------
* После проверки были следующие недочеты :
* 1) OSPF+-
Отсутствует маршрут по умолчани. на коммутаторах ядра. Хосты не имеюд доступа в интернет
C:>ping 8.8.8.8
Reply from 172.16.2.2: Destination host unreachable.
NAT в ЦО настроен корректно, однако из-за проблем с маршрутизацией во внешний мир пользователи не имеют доступа в инетрнет, а внешние хосты не могут достучаться до DMZ сервера.
Заанонсируйте маршрут по умолчанию с основного бордера либо решите вопрос статикой на пути от коммутаторов ядра до бордеров, это допускается.
В остальном OSPF настроен очень хорошо, сеть работает очень стабильно и не имеет петель маршрутизации.
# Ответ :
Это действительно позорище мне, добавил на бордеры 
router ospf 1
default-information originate
и всё запинговалось 
![laptop ping](https://github.com/user-attachments/assets/33bde6bd-bc51-415b-8f85-79ee5028b0a8)
притом если убрать статические маршруты до интернета, то пинговаться перестаёт. 

2) WiFi+-
WiFi в задании требовалось коммутировать траффик клиентов через capwap туннель и контроллер. Прошу изменить режим работы ТД. Если с этим есть сложности просьба расписать.
# Ответ :
там забагалось в CPT , у меня тоже через раз работало , но на самом деле всё в туннеле 
![central](https://github.com/user-attachments/assets/893d5b85-f864-4e6d-b293-d8cdfaf7bff9)
![remote](https://github.com/user-attachments/assets/e6f1e422-3a7b-441d-9344-bcd3fbaa42ea)
![capwap tunnel](https://github.com/user-attachments/assets/d180f7e9-0458-42a4-bee0-89673ffcb04c)

3) DHCP +-
Не выполнено требование филиальным хостам получать настройки DHCP от сервера ЦО.
# Ответ : 
да, везде выставил галочки по дэхацэпэ на эндпоинтах и расширил диапазон на сервере 
![DHCP](https://github.com/user-attachments/assets/54ff1651-cf3e-49f8-8c9d-bf75af19e361)
4) ACL+-
На роутере филиала странный ACL:
interface GigabitEthernet0/0
ip address 172.3.0.2 255.255.255.252
ip access-group 10 out
access-list 10 permit 172.1.0.0 0.0.0.3
access-list 10 permit 172.2.0.0 0.0.0.3
Он не должен пускать в интернет никакие пакеты кроме тех, у которых адрес источника отличется от 172.1.0.0 0.0.0.3 и 172.2.0.0 0.0.0.3. Почему в таком случает траффик доходит до ЦО - загадка, видимо баг CPT. Думаю стоит изменить направление этого ACL на интерфейсе.
Также необходимо чуть более тонко настроить фильтры ACL в ЦО и филиале, чтобы принтеры к примеру могли общаться только с ПК. Посмотреть все требования можно в документе с адресным планом.
# Ответ : 
Согласен по поводу багов, этот CPT сильно забаган, то не работает, то опять нет. По поводу ацэелек, то мне уже лень было переконфигурировать, так как я надеюсь, что уже наиграл на зачет. но выглядить это будет примерно так: 
изменить аут сделать ин ( входное правило ) 
```
ip address 172.3.0.2 255.255.255.252
        ip access-group 10 in 
        access-list 10 permit ip any any
        access-list 10 deny ip any any
        access-list 10 permit ip 172.1.0.0 0.0.0.3 any 
        access-list 10 permit ip 172.2.0.0 0.0.0.3 any 

        а ну и с разделением писюков и принтаков примерно так:
         access-list 100 permit tcp host 192.168.1.10 eq 80 any
        access-list 100 permit udp host 192.168.1.10 eq 53 any
        access-list 100 permit icmp any any
        access-list 100 deny ip any any
```












-----------------------------------------------------------------------------------------------------------------------------
15 сентября 2024 года
Третья итерация (на этот раз уже сконцентрирован и серьёзен, выделил время для дела, а не по 10 минут в обеденом перерыве исравляю недочёты)
Список косяков : 
1) На бордерах ЦО оставлять статику не дело, с базовым BGP у CPT проблем нет. Лучше проверить и найти проблему связности ПК с интернетом, а проблема скорее всего в том, что на коммутаторах ядра маршрут по умолчанию от бордеров появился. Причём сразу два. Мы получаем петлю маршрутизации(проверяется tarcert-ом от клиента). Самый просто вариант её избежать - разорвать ospf соседство между коммутаторами ядра, а при возникновении аварии соседство поднимать. К сожалению CPT до сих пор не поддерживает OSPF external E1 маршруты, а у Е2 одинаковая метрика для каждого пути. Коммутаторы ядра меют маршрут по умолчанию друг на друга.
# Ответ : Статику на бордерах убрал, так же убрал OSPF на втором ядре, вроде всё работает штатно. Изначально хотел сделать neighbor <ip-адрес-соседа> passive, но не нашёл такую команду, как обычно. 
2) Маршрут по умолчания также начал анонситься в филиал, из-за чего получает ошибку
Mar 01, 00:00:45.000: %TUN-5-RECURDOWN: 1 temporarily disabled due to recursive routing
Из-за ошибки сыпятся туннели до ЦО.
Предлагаю заанонсить в филиал только сети ЦО(можно подобрать нестандартный тип зоны), либо вообще прописать статику до и от филиала с разными AD.
Сейчас сеть филиала н имеет связности с ЦО.
# Ответ :  Ошибка: `%TUN-5-RECURDOWN`
Маршрут по умолчанию аннонсируется в филиал, что приводит к ошибке `%TUN-5-RECURDOWN`.
Это связано с рекурсивной маршрутизацией - туннель пытается маршрутизировать трафик через себя, создавая бесконечный цикл.

Варианты Решения:

1 Запретить аннонсирование маршрута по умолчанию в филиал: 
    * В конфигурации OSPF на основном бордере (откуда аннонсируется маршрут по умолчанию) добавитб команду `default-information originate area <номер-области>`
    пробовал, но не получилось, не прошла команда.  
    
2 Статическая маршрутизация: 
    * Вместо OSPF  использовать статические маршруты для связи между филиалом и ЦО. 
    * Настроить статические маршруты с разными `AD` (Administrative Distance) на каждом устройстве, чтобы предотвратить петли. 
    Вот с этим долго игрался, но в итоге проиграл =(((
    
3 Использование нестандартного типа зоны:
    * можно попробовать зааннонсировать только сети ЦО в филиал, используя нестандартный тип зоны OSPF (например, "internal").
    Вот тут есть понимание как и что делать, но потрясающий циско пакет папу его трейсер не даёт мне осуществить задуманное. 
    Идея проста: 
    
    На основном бордере:
```
router ospf 1
  router-id 172.16.1.224
  log-adjacency-changes
  network 172.16.31.16 0.0.0.3 area 0
  network 172.16.31.20 0.0.0.3 area 2
  network 172.16.31.8 0.0.0.3 area 1
  network 172.16.1.224 0.0.0.0 area 1
  default-information originate area 1
  distribute-list 1 out
  ip prefix-list ЦО_сети permit 172.16.1.0 0.0.0.255
  ip prefix-list ЦО_сети permit 172.16.2.0 0.0.0.255
  ip prefix-list ЦО_сети permit 172.16.3.0 0.0.0.255
  area 1 
    default-information originate 
    redistribute connected 
    redistribute static 
    route-map ЦО_сети out
    redistribute prefix-list ЦО_сети 
  !
  area 2 
    default-information originate 
    redistribute connected 
    redistribute static 
    route-map ЦО_сети out
    redistribute prefix-list ЦО_сети 
  !
  area 0 
    default-information originate 
    redistribute connected 
    redistribute static 
    route-map ЦО_сети out
    redistribute prefix-list ЦО_сети 
  !
ip access-list extended ЦО_сети
  permit ip any any
!
route-map ЦО_сети permit 10
 match ip address ЦО_сети
!
```
В общем и целом, я слишком много времени потратил на эту задачу и пожалуй скипну её, при необходимости вернусь к ней позже. 
-------------------------------------------------------------------------
3)
```
На роутере филиала по-прежнему настроен dhcp-сервер. По заданию в компании он единый и располагается в ЦО
ip dhcp pool userpool
network 172.16.8.0 255.255.255.0
default-router 172.16.8.1
ip dhcp pool voippool
network 172.16.9.0 255.255.255.0
default-router 172.16.9.1
option 150 ip 172.16.4.10
ip dhcp pool printer_pool
network 172.16.10.0 255.255.255.0
default-router 172.16.10.1
```
# ответ : удалил dhcp на филиальном роутере. Добавил пулы, доконфигурировал интерфейсы, всё рабоает 
![image](https://github.com/user-attachments/assets/4e817ac1-3b1f-464d-8ca0-8ab81faea457)

![image](https://github.com/user-attachments/assets/8d6ee137-271d-4dc0-9a0b-87a534f7e8d6)

4) Режим работы ТД настраивается на контроллере, сейчас ТД по-прежнему гонят траффик юзеров не через контроллер, а локально. Покажите скриншот, где меняется эта настройка и можно её не менять.
   Воооооооооооооот тутьъ
   
![Снимок экрана 2024-09-15 173112](https://github.com/user-attachments/assets/53346456-9b82-4c58-8dc7-9cae92706713)

